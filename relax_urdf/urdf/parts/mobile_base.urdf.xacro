<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">

<!-- links -->
<link name ="mobile_base_link">  <!-- mobile base link -->
    <inertial>
      <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
      <mass value="100.0"/>
      <inertia ixx="17" ixy="0.0" ixz="0.0" iyy="17" iyz="0.0" izz="17" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="mobile_base_link_visual">
        <mesh filename="package://relax_urdf/meshes/mir_base.stl" scale="0.001 0.001 0.001" />
      </geometry>
      <material name="dark"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="mobile_base_link_collision">
        <mesh filename="package://relax_urdf/meshes/mir_base.stl" scale="0.001 0.001 0.001" />
      </geometry>             
    </collision>
</link> 


<link name ="control_box">
    <inertial>
      <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
      <mass value="1.0"/>
      <inertia ixx="0.17" ixy="0.0" ixz="0.0" iyy="0.17" iyz="0.0" izz="0.17" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="control_box_visual">
          <box size="0.3 0.3 0.15" />
      </geometry>
      <material name="dark"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="control_box_collision">
          <box size="0.3 0.3 0.15" />
      </geometry>             
    </collision>
</link> 

<link name ="left_wheel">
    <inertial>
      <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
      <mass value="1.0"/>
      <inertia ixx="0.17" ixy="0.0" ixz="0.0" iyy="0.17" iyz="0.0" izz="0.17" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="left_wheel_link_visual">
        <mesh filename="package://relax_urdf/meshes/mesh_left_wheel.stl" scale="0.001 0.001 0.001" />
      </geometry>
      <material name="dark"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="left_wheel_link_collision">
        <mesh filename="package://relax_urdf/meshes/mesh_left_wheel.stl" scale="0.001 0.001 0.001" />
      </geometry>             
    </collision>
</link> 

<link name ="right_wheel">
    <inertial>
      <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
      <mass value="1.0"/>
      <inertia ixx="0.17" ixy="0.0" ixz="0.0" iyy="0.17" iyz="0.0" izz="0.17" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="right_wheel_link_visual">
        <mesh filename="package://relax_urdf/meshes/mesh_left_wheel.stl" scale="0.001 0.001 0.001" />
      </geometry>
      <material name="dark"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="right_wheel_link_collision">
        <mesh filename="package://relax_urdf/meshes/mesh_left_wheel.stl" scale="0.001 0.001 0.001" />
      </geometry>             
    </collision>
</link> 

<link name ="left_wheel_yaw">
    <inertial>
      <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
      <mass value="1.0"/>
      <inertia ixx="0.17" ixy="0.0" ixz="0.0" iyy="0.17" iyz="0.0" izz="0.17" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="left_wheel_yaw_link_visual">
        <box size="0.001 0.001 0.001"/>
      </geometry>
      <material name="dark"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="left_wheel_yaw_link_collision">
        <box size="0.001 0.001 0.001"/>
      </geometry>             
    </collision>
</link> 

<link name ="right_wheel_yaw">
    <inertial>
      <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
      <mass value="1.0"/>
      <inertia ixx="0.17" ixy="0.0" ixz="0.0" iyy="0.17" iyz="0.0" izz="0.17" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="right_wheel_yaw_link_visual">
        <box size="0.001 0.001 0.001"/>
      </geometry>
      <material name="dark"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="right_wheel_yaw_link_collision">
        <box size="0.001 0.001 0.001"/>
      </geometry>             
    </collision>
</link> 

<joint name="j_control" type="fixed">
	<parent link="mobile_base_link"/>
	<child link="control_box"/>
    <origin xyz="0 0 ${225.000*mmTom+0.15}" rpy="0 0 0"/>
	<axis xyz="0 0 1"/>
</joint>

<joint name="j_left_wheel_yaw" type="revolute">
	<parent link="mobile_base_link"/>
	<child link="left_wheel_yaw"/>
    <origin xyz="-0.00448719 0.25 0.09" rpy="0 0 0"/>
	<axis xyz="0 0 1"/>
   <limit  effort="35" velocity="20" lower="-1" upper="1" />
</joint>

<joint name="j_right_wheel_yaw" type="revolute">
	<parent link="mobile_base_link"/>
	<child link="right_wheel_yaw"/>
	<origin xyz="-0.00448719 -0.25 0.09" rpy="0 0 0"/>
	<axis xyz="0 0 1"/>
   <limit  effort="35" velocity="20" lower="-1" upper="1" />
</joint>

<joint name="j_left_wheel_roll" type="continuous">
	<parent link="left_wheel_yaw"/>
	<child link="left_wheel"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
	<axis xyz="0 1 0"/>
   <limit  effort="35" velocity="20"/>
</joint>

<joint name="j_right_wheel_roll" type="continuous">
	<parent link="right_wheel_yaw"/>
	<child link="right_wheel"/>
	<origin xyz="0 0 0" rpy="0 0 0"/>
	<axis xyz="0 1 0"/>
   <limit  effort="35" velocity="20"/>
</joint>

<xacro:if value="${ADD_D435I_CONTROL_BOX}">
    <xacro:include filename="$(find realsense_gazebo_description)/urdf/_d435i.urdf.xacro" />
        
        <xacro:sensor_d435i parent="control_box" name="D435i_camera" topics_ns="D435i/D435i_camera"
                      enable_pointCloud="true" align_depth="true"
                      unite_imu_method="false"
                    
                      visualize="false"                                                  
                            
                      accel_fps="300"
                      gyro_fps="300"

                      depth_width="1280"
                      depth_height="720"
                      depth_fps="90"

                      infra_width="1280"
                      infra_height="720"
                      infra_fps="90"

                      color_width="1280"
                      color_height="720"
                      color_fps="30">
            
            <origin xyz="0.18 0 0" rpy="0 -0.5 0"/>
        </xacro:sensor_d435i>
</xacro:if>

</robot>

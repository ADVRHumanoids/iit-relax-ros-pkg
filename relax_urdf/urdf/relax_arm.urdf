<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from relax.urdf.xacro               | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<robot name="relax">
  <!-- none, ball, dagana_fixed, dagana -->
  <material name="black">
    <color rgba="0.4 0.4 0.4 1"/>
  </material>
  <material name="darkblue">
    <color rgba="0.0 0.3 0.9 1"/>
  </material>
  <material name="dark">
    <color rgba="0.1 0.1 0.1 1"/>
  </material>
  <material name="dark_grey">
    <color rgba="0.2 0.2 0.2 1"/>
  </material>
  <link name="world"/>
  <joint name="world_joint" type="fixed">
    <parent link="world"/>
    <child link="base_link"/>
    <origin rpy="0 0 0" xyz="0 0 0"/>
  </joint>
  <!-- The inertia for the MiR platform is intentionally chosen to be smaller than
        the bounding box and also shifted a bit to the back, because most of the mass
        is in the lower center back (because of the batteries). -->
  <link name="base_link">
    <inertial>
      <mass value="97.0"/>
      <origin rpy="0 0 0" xyz="-0.054485000000000006 0.0 0.15"/>
      <inertia ixx="1.050832913" ixy="0.0" ixz="0.0" iyy="2.344165729" iyz="0.0" izz="2.7483322339999994"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="-0.004485 0 0"/>
      <geometry>
        <mesh filename="package://relax_urdf/meshes/mesh_base_revised.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="dark_grey"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="-0.004485 0 0"/>
      <geometry>
        <mesh filename="package://relax_urdf/meshes/mesh_base_revised.stl" scale="0.001 0.001 0.001"/>
      </geometry>
    </collision>
  </link>
  <!-- ARM -->
  <!-- ARM -->
  <!-- ARM -->
  <!-- ARM -->
  <!-- links -->
  <link name="relax_arm1_link1">
    <!-- link 1 -->
    <inertial>
      <origin xyz="-0.0018991406 0.022645162 0.11325297000000001"/>
      <mass value="6.2381702"/>
      <inertia ixx="0.065816037" ixy="-0.00011791629" ixz="-4.0067927e-05" iyy="0.057828314" iyz="-0.011584403" izz="0.01940196"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link1_visual">
        <mesh filename="package://relax_urdf/meshes/mesh_link1.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="darkblue"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link1_collision">
        <mesh filename="package://relax_urdf/meshes/mesh_link1.stl" scale="0.001 0.001 0.001"/>
      </geometry>
    </collision>
  </link>
  <link name="relax_arm1_link2">
    <!-- link 2 -->
    <inertial>
      <origin xyz="-3.1494342e-05 -0.20005579 -0.0057041875"/>
      <mass value="2.601371"/>
      <inertia ixx="0.064570453" ixy="-0.00019926537999999998" ixz="-1.6866045999999998e-06" iyy="0.0051512542" iyz="-2.9627309e-06" izz="0.06672465300000001"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link2_visual">
        <mesh filename="package://relax_urdf/meshes/mesh_link2.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="dark"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link2_collision">
        <mesh filename="package://relax_urdf/meshes/mesh_link2.stl" scale="0.001 0.001 0.001"/>
      </geometry>
    </collision>
  </link>
  <link name="relax_arm1_link3">
    <!-- link 3 -->
    <inertial>
      <origin xyz="0.0020858498 -0.078452653 -0.10797347"/>
      <mass value="5.9482803"/>
      <inertia ixx="0.062877846" ixy="0.00011665783" ixz="0.00012931181" iyy="0.018390664" iyz="-0.011034081" izz="0.055056825999999996"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link3_visual">
        <mesh filename="package://relax_urdf/meshes/mesh_link3.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="darkblue"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link3_collision">
        <mesh filename="package://relax_urdf/meshes/mesh_link3.stl" scale="0.001 0.001 0.001"/>
      </geometry>
    </collision>
  </link>
  <link name="relax_arm1_link4">
    <!-- link 4 -->
    <inertial>
      <origin xyz="0.00096471566 -0.0042586853 0.046169896"/>
      <mass value="1.6710337"/>
      <inertia ixx="0.017329393999999998" ixy="0.00021094011" ixz="-0.00024511391" iyy="0.010036060999999999" iyz="0.00042230531" izz="0.012350325"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link4_visual">
        <mesh filename="package://relax_urdf/meshes/mesh_link4.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="darkblue"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link4_collision">
        <mesh filename="package://relax_urdf/meshes/mesh_link4.stl" scale="0.001 0.001 0.001"/>
      </geometry>
    </collision>
  </link>
  <link name="relax_arm1_link5">
    <!-- link 5 -->
    <inertial>
      <origin xyz="-0.0013991722 0.052618238 -0.08425954199999999"/>
      <mass value="6.181102"/>
      <inertia ixx="0.059736008" ixy="-0.00014975682" ixz="-5.2815066e-05" iyy="0.015244194999999999" iyz="0.0011994937999999999" izz="0.055701504"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link5_visual">
        <mesh filename="package://relax_urdf/meshes/mesh_link5.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="darkblue"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link5_collision">
        <mesh filename="package://relax_urdf/meshes/mesh_link5.stl" scale="0.001 0.001 0.001"/>
      </geometry>
    </collision>
  </link>
  <link name="relax_arm1_link6">
    <!-- link 6 -->
    <inertial>
      <origin xyz="0.0005687903199999999 0.0 0.0022653642000000002"/>
      <mass value="0.48141935"/>
      <inertia ixx="0.0008220642" ixy="1.0675057e-07" ixz="3.5319177e-07" iyy="0.00083596992" iyz="0.0" izz="0.0012890535"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link6_visual">
        <mesh filename="package://relax_urdf/meshes/mesh_link6.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="darkblue"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry name="relax_link6_collision">
        <mesh filename="package://relax_urdf/meshes/mesh_link6.stl" scale="0.001 0.001 0.001"/>
      </geometry>
    </collision>
  </link>
  <link name="relax_arm1_linkEndEffector"/>
  <!-- link End-Effector -->
  <!-- joints -->
  <joint name="relax_arm1_joint0" type="revolute">
    <!-- joint 1 -->
    <parent link="base_link"/>
    <child link="relax_arm1_link1"/>
    <origin rpy="0.0 0.0 0.0" xyz="-0.13448500000000002 0.0 0.40986"/>
    <axis xyz="0 0 1"/>
    <limit effort="147.0" lower="-2.7" upper="2.7" velocity="3.86"/>
    <dynamics damping="0.2" friction="10.0"/>
  </joint>
  <joint name="relax_arm1_joint1" type="revolute">
    <!-- joint 1 -->
    <parent link="relax_arm1_link1"/>
    <child link="relax_arm1_link2"/>
    <origin rpy="-1.5707963 0.0 0.0" xyz="0.0 0.13166 0.1955"/>
    <axis xyz="0 0 1"/>
    <limit effort="147.0" lower="-2.7" upper="2.7" velocity="3.86"/>
    <dynamics damping="0.2" friction="10.0"/>
  </joint>
  <joint name="relax_arm1_joint2" type="revolute">
    <!-- joint 2 -->
    <parent link="relax_arm1_link2"/>
    <child link="relax_arm1_link3"/>
    <origin rpy="0.0 0.0 0.0" xyz="0.0 -0.4 0.0"/>
    <axis xyz="0 0 -1"/>
    <limit effort="147.0" lower="-2.7" upper="2.7" velocity="3.86"/>
    <dynamics damping="0.2" friction="10.0"/>
  </joint>
  <joint name="relax_arm1_joint3" type="revolute">
    <!-- joint 3 -->
    <parent link="relax_arm1_link3"/>
    <child link="relax_arm1_link4"/>
    <origin rpy="1.5707963 0.0 0.0" xyz="0.0 -0.24966 -0.13166"/>
    <axis xyz="0 0 1"/>
    <limit effort="147.0" lower="-2.7" upper="2.7" velocity="3.86"/>
    <dynamics damping="0.2" friction="10.0"/>
  </joint>
  <joint name="relax_arm1_joint4" type="revolute">
    <!-- joint 4 -->
    <parent link="relax_arm1_link4"/>
    <child link="relax_arm1_link5"/>
    <origin rpy="1.5707963 0.0 0.0" xyz="0.0 -0.08816 0.1535"/>
    <axis xyz="0 0 -1"/>
    <limit effort="147.0" lower="-2.0" upper="2.0" velocity="3.86"/>
    <dynamics damping="0.2" friction="10.0"/>
  </joint>
  <joint name="relax_arm1_joint5" type="revolute">
    <!-- joint 5 -->
    <parent link="relax_arm1_link5"/>
    <child link="relax_arm1_link6"/>
    <origin rpy="-1.5707963 0.0 0.0" xyz="0.0 0.22216 -0.08816"/>
    <axis xyz="0 0 1"/>
    <limit effort="147.0" lower="-2.7" upper="2.7" velocity="3.86"/>
    <dynamics damping="0.2" friction="10.0"/>
  </joint>
  <joint name="relax_arm1_joint6" type="fixed">
    <!-- joint 6 fake -->
    <parent link="relax_arm1_link6"/>
    <child link="relax_arm1_linkEndEffector"/>
    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.028"/>
  </joint>
  <material name="dagana_dark_grey">
    <color rgba="0.2 0.2 0.2 1"/>
  </material>
  <joint name="dagana_1_mount_joint" type="fixed">
    <origin rpy="0. 0 0" xyz="0. 0 0"/>
    <parent link="relax_arm1_linkEndEffector"/>
    <child link="dagana_1_top_link"/>
  </joint>
  <link name="dagana_1_top_link">
    <inertial>
      <origin rpy="0 0 0" xyz="-0.0063562154 -0.0060265532000000005  0.060068288000000004"/>
      <mass value="1.7432400"/>
      <inertia ixx="0.0050510328" ixy="-0.00025264216" ixz="-0.00012103013" iyy="0.0047944612" iyz="-0.00073917704" izz="0.0031156997"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://dagana_urdf/meshes/dg0001-simplified.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="dagana_dark_grey"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://dagana_urdf/meshes/dg0001-simplified_v2.stl" scale="0.001 0.001 0.001"/>
      </geometry>
    </collision>
  </link>
  <joint name="dagana_1_claw_joint" type="revolute">
    <origin rpy="1.57079632679 0 3.14159265359" xyz="0.0 -0.028 0.05025"/>
    <parent link="dagana_1_top_link"/>
    <child link="dagana_1_bottom_link"/>
    <axis xyz="-1 0 0"/>
    <limit effort="1000" lower="0" upper="1.3" velocity="10.0"/>
  </joint>
  <link name="dagana_1_bottom_link">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0.069644767 0"/>
      <mass value="4.6117745e-01"/>
      <inertia ixx="0.0014726990999999999" ixy="7.134683e-05" ixz="2.529065e-06" iyy="0.0009385556899999999" iyz="-0.000264452" izz="0.0019472731"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://dagana_urdf/meshes/dg0002.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="dagana_dark_grey"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://dagana_urdf/meshes/dg0002-ch.stl" scale="0.001 0.001 0.001"/>
      </geometry>
    </collision>
  </link>
  <!-- Manually put to have a transform in a "good" grasping spot-->
  <joint name="dagana_1_tcp_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0 -0.05 0.15"/>
    <parent link="dagana_1_top_link"/>
    <child link="dagana_1_tcp"/>
  </joint>
  <link name="dagana_1_tcp"/>
  <gazebo reference="dagana_1_bottom_link">
    <material>Gazebo/DarkGrey</material>
  </gazebo>
  <gazebo reference="dagana_1_top_link">
    <material>Gazebo/DarkGrey</material>
  </gazebo>
  <link name="nicla_base">
    <visual>
      <origin rpy="0 0 0" xyz="-0.01143 -0.01143 0"/>
      <geometry>
        <mesh filename="package://nicla_vision_ros/urdf/meshes/niclavision.dae" scale="0.001 0.001 0.001"/>
        <!-- <mesh filename="package://nicla_vision_ros/urdf/meshes/niclavision.stl" scale="0.001 0.001 0.001" /> -->
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02286  0.02286 0.004"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.01"/>
      <inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01"/>
    </inertial>
  </link>
  <joint name="dagana_1_top_link_to_nicla_base" type="fixed">
    <origin rpy="0 0 3.14159265359" xyz="-0.002506 -0.0157197 0.0994715"/>
    <parent link="dagana_1_top_link"/>
    <child link="nicla_base"/>
  </joint>
  <link name="nicla_camera"/>
  <joint name="nicla_base_to_camera" type="fixed">
    <origin rpy="0 -1.57079632679 1.570796326795" xyz="-0.00255 0.00778 0.0045"/>
    <parent link="nicla_base"/>
    <child link="nicla_camera"/>
  </joint>
  <!-- gazebo simulated camera -->
  <gazebo reference="nicla_camera">
    <sensor name="nicla_camera" type="camera">
      <update_rate>30.0</update_rate>
      <camera name="nicla_camera">
        <horizontal_fov>0.69813</horizontal_fov>
        <!-- 80deg 1.39626rad-->
        <image>
          <width>320</width>
          <height>240</height>
          <format>R8G8B8</format>
        </image>
        <clip>
          <near>0.1</near>
          <far>100</far>
        </clip>
        <!-- <lens>
                <intrinsics>
                    <fx>439.597550</fx>
                    <fy>439.597550</fy>
                    <cx>166.12451</cx>
                    <cy>104.41054</cy>
                    <s>0</s>
                </intrinsics>
            </lens> -->
      </camera>
      <plugin filename="libgazebo_ros_camera.so" name="gazebo_ros_nicla_camera_controller">
        <alwaysOn>true</alwaysOn>
        <updateRate>0.0</updateRate>
        <cameraName>nicla/camera</cameraName>
        <imageTopicName>image_raw</imageTopicName>
        <cameraInfoTopicName>camera_info</cameraInfoTopicName>
        <frameName>nicla_camera</frameName>
        <!-- Set to 0.0 -->
        <!-- <hackBaseline>0.0</hackBaseline>  -->
        <!-- Set to your k1 value -->
        <!-- <distortionK1>0.176808</distortionK1>  -->
        <!-- Set to your k2 value -->
        <!-- <distortionK2>-0.590488</distortionK2>  -->
        <!-- Set to your k3 value -->
        <!-- <distortionK3>0.0</distortionK3>  -->
        <!-- Set to your p1 value -->
        <!-- <distortionT1>-0.008412</distortionT1>  -->
        <!-- Set to your p2 value -->
        <!-- <distortionT2>0.015473</distortionT2>  -->
        <!-- Set to 0 -->
        <!-- <CxPrime>166.12451</CxPrime>  -->
        <!-- Set to your Cx value -->
        <!-- <Cx>166.12451</Cx>  -->
        <!-- Set to your Cy value -->
        <!-- <Cy>104.41054</Cy>  -->
        <!-- Set to your focal length value-->
        <!-- <focalLength>439.597550</focalLength>  -->
        <!-- 
        Camera matrix K: 
                        [fx, 0., cx,
                         0., fy, cy,
                         0., 0.,  1.] =

        [416.65053,   0.     , 166.12451,
           0.     , 419.40464, 104.41054,
           0.     ,   0.     ,   1.     ]

        Note: 
        - ideally fx == fy
        - ideally focalLenght = fx = fy
        - focalLength = fx+fy/2 = 418.027585 
            but focalLength MUST be img_width/(2.0*(tan(HFOV/2.0))) = 439.597550
        

        Distortion coefficients D (OpenCV plumb_bob model):
        [k1,k2,t1,t2,k3]=[0.176808, -0.590488, -0.008412, 0.015473, 0.000000] -->
      </plugin>
    </sensor>
  </gazebo>
  <link name="nicla_tof"/>
  <joint name="nicla_base_to_tof" type="fixed">
    <origin rpy="0 -1.57079632679 0" xyz="-0.003 0.0032 0.0017"/>
    <parent link="nicla_base"/>
    <child link="nicla_tof"/>
  </joint>
  <!-- gazebo simulated tof -->
  <gazebo reference="nicla_tof">
    <sensor name="nicla_tof" type="ray">
      <pose>0 0 0 0 0 0</pose>
      <visualize>True</visualize>
      <update_rate>50</update_rate>
      <ray>
        <scan>
          <horizontal>
            <samples>1</samples>
            <resolution>1</resolution>
            <min_angle>0</min_angle>
            <max_angle>0</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.04</min>
          <max>4</max>
          <resolution>0.03</resolution>
        </range>
        <!-- <noise>
                <type>gaussian</type>
                <mean>0.0</mean>
                <stddev>0.01</stddev>
            </noise> -->
      </ray>
      <plugin filename="libgazebo_ros_laser.so" name="gazebo_ros_nicla_tof_controller">
        <topicName>nicla/tof</topicName>
        <frameName>nicla_tof</frameName>
      </plugin>
    </sensor>
  </gazebo>
  <link name="nicla_mic"/>
  <joint name="nicla_base_to_mic" type="fixed">
    <origin rpy="0 0 0" xyz="-0.0073 0.0048 0.0013"/>
    <parent link="nicla_base"/>
    <child link="nicla_mic"/>
  </joint>
  <link name="nicla_imu"/>
  <joint name="nicla_base_to_imu" type="fixed">
    <origin rpy="0 0 0" xyz="-0.0078 -0.0046 -0.0015"/>
    <parent link="nicla_base"/>
    <child link="nicla_imu"/>
  </joint>
  <gazebo reference="nicla_imu">
    <gravity>true</gravity>
    <sensor name="nicla_imu_sensor" type="imu">
      <always_on>true</always_on>
      <update_rate>100</update_rate>
      <visualize>true</visualize>
      <topic>{name}/imu</topic>
      <plugin filename="libgazebo_ros_imu_sensor.so" name="imu_plugin">
        <topicName>nicla/imu</topicName>
        <bodyName>nicla_imu</bodyName>
        <updateRateHZ>833</updateRateHZ>
        <gaussianNoise>0.0</gaussianNoise>
        <xyzOffset>0 0 0</xyzOffset>
        <rpyOffset>0 0 0</rpyOffset>
        <frameName>nicla_imu</frameName>
        <initialOrientationAsReference>false</initialOrientationAsReference>
      </plugin>
      <pose>0 0 0 0 0 0</pose>
    </sensor>
  </gazebo>
  <!--     to have the same final link as when "none" option is used     -->
  <link name="tcp_1"/>
  <joint name="j_tcp_1" type="fixed">
    <parent link="dagana_1_tcp"/>
    <child link="tcp_1"/>
    <origin rpy="0 0 0" xyz="0 0 0"/>
  </joint>
</robot>
